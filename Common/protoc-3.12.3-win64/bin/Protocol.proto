syntax = "proto3";

package Protocol;
option csharp_namespace = "Google.Protobuf.Protocol";

enum MsgId {
  S_ENTER_GAME = 0;
  S_LEAVE_GAME = 1;
  S_SPAWN = 2;
  S_DESPAWN = 3;
  C_MOVE = 4;
  S_MOVE = 5;
  C_SKILL = 6;
  S_SKILL = 7;
  S_CHANGE_HP = 8;
  S_DIE = 9;
  S_CONNECTED = 10;
  C_LOGIN = 11;
  S_LOGIN = 12;
  C_ENTER_GAME = 13;
  C_CREATE_PLAYER = 14;
  S_CREATE_PLAYER = 15;
  S_ITEM_LIST = 16;
  S_ADD_ITEM = 17;
  C_EQUIP_ITEM = 18;
  S_EQUIP_ITEM = 19;
  S_CHANGE_STAT = 20;
  S_PING = 21;
  C_PONG = 22;
  S_MY_PLAYER_ENTER_LOBBY = 23;
  S_OTHER_PLAYER_ENTER_LOBBY = 24;
  S_PLAYER_LEAVE_LOBBY = 25;
  C_CHATTING = 26;
  S_CHATTING = 27;
  C_ENTER_STORE = 28;
  C_ENTER_LOBBY = 29;
  C_ADD_MONEY = 30;
  S_ADD_MONEY = 31;
  C_CREATE_ROOM = 32;
  S_ALTER_ROOM = 33;
  C_JOIN_ROOM = 34;
  S_JOIN_ROOM = 35; 
  S_JOIN_ROOM_BROADCAST = 36;
  S_EXIT_ROOM_BROADCAST = 37;
  S_GAMEROOM_CHAR_STATE = 38;
  S_ALTER_HOST = 39;
  C_KICK_PLAYER = 40;
  S_CHANGE_SCENE = 41;
  C_CHANGE_SCENE_COMPLETED = 42;
  C_START_GAME = 43;
  C_READYBTN_CLICKED = 44;
  C_CHANGE_SLOT_STATE = 45;
  S_CHANGE_SLOT_STATE_BROADCAST = 46;
  C_CHARACTER_SELECT = 47;
  S_CHARACTER_SELECT_RESPONSE = 48;
  S_CHARACTER_SELECT_BROADCAST = 49;
  S_START_GAME_RES = 51;
  S_START_GAME_BROADCAST = 52;
  C_MAP_SELECT = 53;
  S_MAP_SELECT_BROADCAST = 54;
  S_SPAWN_OBJECT = 55;
  C_GAME_SCENE_LOAD_FINISHED = 56;
  S_OWN_PLAYER_INFORM = 57;
  S_NOT_OWN_PLAYER_INFORM = 58;
  C_CA_MOVE = 59;
  C_INSTALL_BOMB = 60;
  S_INSTALL_BOMB = 61;
  S_DESTROY_OBJECT = 62;
  S_CHANGE_ANIMATION = 63;
  S_DESTROY_BOX = 64;
}

enum ObjectType  {
   OBJECT_NONE = 0;
   OBJECT_PLAYER = 1;
   OBJECT_MONSTER = 2;
   OBJECT_PROJECTILE = 3;
   OBJECT_BOX = 4;
   OBJECT_BOMB = 5;
   OBJECT_WATER_STREAM = 6;
   OBJECT_WALL = 7;
}

enum CreatureState {
  IDLE = 0;
  MOVING = 1;
  SKILL = 2;
  BUBBLE_IDLE = 3; 
  BUBBLE_MOVING = 4;
  DEAD = 5;
}

enum CACreatureState {
  CA_IDLE = 0;
  CA_MOVING = 1;
  CA_DEAD = 2; 
}

enum PositionType {

  TILE_CENTER_POS = 0;
  TILE_UNDER_POS = 1;
  ABSOLUTE_POS = 2;
}

enum LayerType {
  DEFAULT_LAYER = 0;
  CHARACTER_LAYER = 1;
  WATERSTREAM_LAYER = 2;
  ITEM_LAYER = 3;
  BOX_LAYER = 4;
}

enum MoveDir {
  MOVE_NONE = 0;
  UP = 1;
  DOWN = 2;
  LEFT = 3;
  RIGHT = 4;
}

enum GameSceneType 
{
  C_A_Main_Lobby = 0;
  C_A_Store = 1;
  C_A_Game_Room = 2;
}

enum GameObjectType {
   NONE = 0;
   PLAYER = 1;
   MONSTER = 2;
   PROJECTILE = 3;
}

enum CharacterType  {
  DAO = 0;
  BAZZI = 1;
  KEFI = 2;
  MARID = 3;
  CHARACTER_NONE = 4;
}

enum SkillType {
  SKILL_NONE = 0;
  SKILL_AUTO = 1;
  SKILL_PROJECTILE = 2;
}

enum PlayerServerState {
  SERVER_STATE_LOGIN = 0;
  SERVER_STATE_LOBBY = 1;
  SERVER_STATE_STORE = 2;
  SERVER_STATE_ROOM  = 3;
  SERVER_STATE_GAME  = 4;
}

enum ItemType {
  ITEM_TYPE_NONE = 0;
  ITEM_TYPE_WEAPON = 1;
  ITEM_TYPE_ARMOR = 2;
  ITEM_TYPE_CONSUMABLE = 3;
}

enum WeaponType {
  WEAPON_TYPE_NONE = 0;
  WEAPON_TYPE_SWORD = 1;
  WEAPON_TYPE_BOW = 2;
}

enum ArmorType {
  ARMOR_TYPE_NONE = 0;
  ARMOR_TYPE_HELMET = 1;
  ARMOR_TYPE_ARMOR = 2;
  ARMOR_TYPE_BOOTS = 3;
}

enum CharacterSpawnType {
  SPAWN_NOTHING = 0;
  SPAWN_RANDOM = 1;
  SPAWN_BAZZI = 2;
  SPAWN_DAO = 3;
}

enum ConsumableType {
   CONSUMABLE_TYPE_NONE = 0;
   CONSUMABLE_TYPE_POTION = 1;
}

enum WaterStreamType {
  STREAM_CENTER = 0;
  STREAM_DOWN = 1;
  STREAM_DOWN_EDGE = 2;
  STREAM_RIGHT = 3;
  STREAM_RIGHT_EDGE = 4;
  STREAM_LEFT = 5;
  STREAM_LEFT_EDGE = 6;
  STREAM_UP = 7;
  STREAM_UP_EDGE = 8;
}


enum MapType {
   DESERT1 = 0;
   MINE1 = 1;
   CAMP8 = 2;
   FOREST7 = 3;
   PIRATE14 = 4;
   TOMB12 = 5;
   GOLEM7 = 6;
   OCTOPUS1 = 7;
   PENGUIN1 = 8;
   ROBOT1 = 9;
   SEAL1 = 10;
   TURTLE1 = 11;
}

enum MapTeamType {
  FOUR_TEAM = 0;
  TWO_TEAM = 1;
}

enum TeamModeType 
{
  MANNER_MODE = 0;
  FREE_MODE = 1;
  RANDOM_MODE = 2;
}

enum GameModeType
{
  NORMAL_MODE = 0;
  MONSTER_MODE = 1;
  A_I_MODE = 2;
}

enum RoomStateType
{
  WAITING = 0;
  FULL = 1;
  PLAYING = 2;
}

enum JoinResultType
{
  SUCCESS = 0;
  ROOM_NOT_EXIST = 1;
  ROOM_FULL = 2;
  GAME_ALREADY_STARTED = 3; 
}

enum RoomAlterType
{
  ADD = 0;
  DELETE = 1;
  ALTER = 2;
}

 

enum GameRoomCharacterStateType
{
  HOST = 0;
  READY = 1;
  NOT_READY = 2;
  STORE = 3;
}

enum ObjectSpawnKeyType 
{
  CHARACTER = 0;
  BOMB = 1; 
  WATERSTREAM = 2;
  BOX = 3;
  WALL = 4;
}

enum BombType 
{
  BLACK = 0;
  COKE = 1; 
}

message S_EnterGame {
  ObjectInfo player = 1;
}

message S_LeaveGame {
}

message S_Spawn {
  repeated ObjectInfo objects = 1;
}

message S_Despawn {
  repeated int32 objectIds = 1;
}

message C_Move {
  PositionInfo posInfo = 1;
}

message C_CaMove {
  MoveDir dir  = 1;
}

message S_Move {
  int32 objectId = 1;
  PositionInfo posInfo = 2;
}

message C_Skill {
  SkillInfo info = 1;
}

message S_Skill {
  int32 objectId = 1;
  SkillInfo info = 2;
}

message S_ChangeHp {
  int32 objectId = 1;
  int32 hp = 2;
}

message S_Die {
  int32 objectId = 1;
  int32 attackerId = 2;
}

message S_Connected {
}

message C_Login {
  string uniqueId = 1;
}

message S_Login {
  int32 loginOk = 1;
  repeated LobbyPlayerInfo players = 2;
}

message C_CreatePlayer {
  string name = 1;
}

message S_CreatePlayer {
  LobbyPlayerInfo player = 1;
}

message C_EnterGame {
  string name = 1;
}

message C_EnterStore {
  LobbyPlayerInfo player = 1;
}

message C_EnterLobby {
  LobbyPlayerInfo player = 1;
}

message C_GameSceneLoadFinished {
  
}

message C_ChangeSlotState  {
  int32 slotidx = 1;
  bool  isopen = 2;
}

message S_ChangeSlotStateBroadcast {
  int32 slotidx = 1;
  bool  isopen = 2;
}
 
message S_ItemList {
  repeated ItemInfo items = 1;
}

message C_AddMoney {
  int32 moneyamount = 1;
}

message S_AddMoney {
  int32 moneyamount = 1;
}

message S_AddItem {
  repeated ItemInfo items = 1;
}

message C_EquipItem {
  int32 itemDbId = 1;
  bool equipped = 2;
}

message S_EquipItem {
  int32 itemDbId = 1;
  bool equipped = 2;
}

message C_StartGame {

}


message S_StartGameRes
{
  bool isSuccess = 1;
}

message S_StartGameBroadcast
{
  MapType maptype = 1;
}

message S_OwnPlayerInform 
{
  int32 objid = 1;
  LayerType layerinfo = 2;
  CharacterType chartype = 4;
}

message S_NotOwnPlayerInform 
{
  int32 objid = 1;
  LayerType layerinfo = 2;
  CharacterType chartype = 3;
}


message C_ReadybtnClicked {

}

message S_ChangeStat {
  StatInfo statInfo = 1;
}

message S_Ping {
}

message C_Pong {
}


message S_Chatting {
  string name = 1;
  string chat = 2;
}

message C_Chatting {
  string name = 1;
  string chat = 2;
}

message KeyValuePairs  {
  ObjectSpawnKeyType key = 1;
  oneof value {
    string string_value = 2;
    int32  int_value = 3;
    float  float_value = 4;
    ObjectSpawnPlayerValue player_info_vlaue = 5;
    BombInfoValue Bomb_info_value = 6;
    WaterStreamType Stream_info_value = 7;
    TileInfoValue Tile_info_value = 8;
  }
}

message ObjectSpawnPlayerValue {
  CharacterType charactertype_value = 1;
}

message BombInfoValue 
{
  BombType bombType = 1;
  float bombPosX = 2;
  float bombPosY = 3; 
}

message TileInfoValue
{
  string tilename = 1;
  string atlasname = 2;
}

message S_SpawnObject {
  int32        objectid     = 1;
  ObjectType   objecttype   = 2;
  PositionInfo positioninfo = 3;
  LayerType    objectlayer  = 4;
  repeated KeyValuePairs additional_data = 5;
}

message S_DestroyObject  {
  int32 objectId     = 1;
}

message S_DestroyBox {
  int32 objectId = 1;
}

message LobbyPlayerInfo {
  int32 playerDbId = 1;
  string name = 2;
  LevelInfo LevelInfo = 3;
}

message S_MyPlayerEnterLobby { 
  LobbyPlayerInfo  player = 1;
}

message S_OtherPlayerEnterLobby {
  repeated LobbyPlayerInfo otherplayers = 1;
}

message S_PlayerLeaveLobby {
  LobbyPlayerInfo player = 1;
}

message C_CreateRoom {
  RoomInfo roominfo = 1;
}

message S_AlterRoom {
  RoomAlterType altertype = 1;
  RoomInfo roominfo = 2;
}

message C_JoinRoom {
  int32  roomid = 1;
}

message S_JoinRoom {
  JoinResultType joinresult = 1;
  repeated SlotInfo slotInfos = 2;
  int32 hostIdx = 3;
  int32 clientslotIdx = 4;
  MapType maptype = 5;
  GameModeType gamemode = 6;
}

message S_AlterHost {
  int32 previousidx = 1;
  int32 nowidx = 2;
}

message C_KickPlayer 
{
  int32 slotidx = 1;
}

message C_MapSelect
{
  MapType maptype = 1;
}

message S_MapSelectBroadcast
{
  MapType maptype = 1;
  MapTeamType mapTeamType = 2;
}

message C_CharacterSelect {
  CharacterType chartype = 1;
}

message S_CharacterSelectResponse {
  bool isSuccess = 1;
  CharacterType chartype = 2;
}

message S_CharacterSelectBroadcast {
  int32 slotid = 1;
  CharacterType chartype = 2;
}

message S_ChangeScene
{
  GameSceneType scene = 1;
}

message C_ChangeSceneCompleted
{
  GameSceneType scene = 1;
}

message C_InstallBomb
{
   int32 power = 1; 
   BombType bombType = 2; 
   float charPosX = 3;
   float charPosY = 4;

}

message S_InstallBomb
{
  BombType bombType = 1;
  float bombPosX = 2;
  float bombPosY = 3; 
}


message S_JoinRoomBroadcast {
  SlotInfo slotInfo = 1;
}

message S_ExitRoomBroadcast {
  int32 slotId = 1;
}

message S_GameroomCharState {
  int32 slotId = 1;
  GameRoomCharacterStateType charstate = 2;
}

message S_ChangeAnimation {
  int32 objectId = 1;
  oneof anim_state {
    PlayerAnimState   player_anim = 2; 
    Monster1AnimState monster_anim = 3;
  }
}

message ObjectInfo {
  int32 objectId = 1;
  string name = 2;
  PositionInfo posInfo = 3;
}

message PositionInfo {
  MoveDir moveDir = 1;
  PositionType type = 2;
  float posX = 3;
  float posY = 4;
  CreatureState state = 5;
}

message LevelInfo {
  int32 level = 1;
  int32 curexp = 2;
}

message StatInfo {
  int32 level = 1;
  int32 hp = 2;
  int32 maxHp = 3;
  int32 attack = 4;
  float speed = 5;
  int32 totalExp = 6;
}

message SkillInfo {
  int32 skillId = 1;
}

message ItemInfo {
  int32 itemDbId = 1;
  int32 templateId = 2;
  int32 count = 3;
  int32 slot = 4;
  bool equipped = 5;
}

message RoomInfo 
{
  int32  RoomNumber = 1;
  string RoomName = 2;
  string MapImagePath = 3;
  int32  CurPeopleCnt = 4;
  int32  MaxPeopleCnt = 5;
  RoomStateType RoomState = 6;
  TeamModeType TeamMode = 7;
  GameModeType GameMode = 8;
  bool isSecretRoom = 9;
}

message SlotInfo
{
  int32 SlotIndex = 1;
  bool  IsAvailable = 2;
  int32 PlayerId = 3;
  CharacterType character = 4;
  GameRoomCharacterStateType characterState = 5;
}
 
enum PlayerAnimState 
{
  PLAYER_ANIM_IDLE = 0;
  PLAYER_ANIM_MOVING = 1;
  PLAYER_ANIM_BUBBLE = 2;
  PLAYER_ANIM_BUBBLE_EMERGENCY = 3;
  PLAYER_ANIM_DEAD = 4; 
  PLAYER_ANIM_BUBBLE_ESCAPE = 5;
}

enum Monster1AnimState
{
  MONSTER1_ANIM_TEST1 = 0;
  MONSTER1_ANIM_TEST2 = 1;
  MONSTER1_ANIM_TEST3 = 2;
}
